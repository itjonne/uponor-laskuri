{"version":3,"sources":["components/Inputs.js","components/Companies.js","components/Outputs.js","components/Calculator.js","App.js","index.js"],"names":["Inputs","inputs","className","Companies","data","Object","keys","map","key","i","nimi","value","position","length","toFixed","Outputs","outputs","j","labels","label","companies","Calculator","useState","setInputs","setOutputs","workbook","setWorkbook","useForm","register","handleSubmit","errors","formState","setInputsToExcel","worksheet","Sheets","v","parseFloat","w","getOutputsFromExcel","alert","XLSX_CALC","vip","values","thermo","rauheat","calpex","terrendis","microflex","meltex","outputData","outputSheet","SheetNames","lampohavioArray","_","range","lampohavioLabels","push","company","yritys","parseInt","kustannuksetArray","kustannuksetLabels","kumulatiivisetArray","kumulatiivisetLabels","eroArray","eroLabels","undefined","createLocationString","letter","number","toString","useEffect","handleExcelUpload","e","preventDefault","f","target","files","reader","FileReader","onload","result","XLSX","read","type","createInputs","readAsBinaryString","thermoArray","inputsArray","putket","createInput","aquaArray","putketBlock","lampotilaArray","lampotilat","lampotilatBlock","kayttoajatArray","kayttoajat","kayttoajatBlock","energianHintaArray","energianHinta","energianHintaBlock","location","labelValue","valueValue","defaultValue","min","max","input","document","getElementById","addEventListener","readExcel","id","onSubmit","App","alt","src","ReactDOM","render"],"mappings":"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","file":"static/js/main.8a9920c4.chunk.js","sourcesContent":["const Inputs = ({inputs}) => {\n  return (\n    <div className=\"form\">\n      {inputs}\n    </div>\n  )\n};\n\nexport default Inputs;\n","const Companies = ({data}) => {\n  const calculateClassName = (position, length) => {\n    return position === length - 1 ? 'bold' : '';\n  }\n  return (\n    Object.keys(data).map((key,i) => (\n      <div className=\"company\" key={`company-${i}`}>\n        <div className=\"bold\">{data[key].nimi}</div>\n      <div className=\"column\">\n        {data[key].data.map((value,i) => <div className={calculateClassName(i, data[key].data.length)} key={`${value}-${i}`}>{value.toFixed(0)}</div>)}     \n      </div>\n      </div>\n\n    ))\n  );\n};\n\nexport default Companies;\n","import Companies from \"./Companies\";\n\nconst Outputs = ({outputs}) => {\n  const keys = Object.keys(outputs);\n\n  const calculateClassName = (position, length) => {\n    return position === length - 1 ? 'bold' : '';\n  }\n\n  return (\n    <div>\n      {keys.map((key,j) => (\n        <div key={`output-${j}`}>\n        <div className=\"otsikko\">{key}</div>\n        <div className=\"row\">\n          <div className=\"column\">\n            {outputs[key].labels.map((label,i) => <div className={calculateClassName(i, outputs[key].labels.length)} key={label}>{label}</div>)}     \n          </div>\n            <Companies data={outputs[key].companies} />\n        </div>    \n        </div>  \n      ))}\n    </div>\n  )\n  \n};\n\nexport default Outputs;\n","import React, { useEffect, useState } from 'react';\nimport XLSX from 'xlsx';\nimport XLSX_CALC from 'xlsx-calc';\nimport _ from 'lodash';\nimport { useForm } from \"react-hook-form\";\nimport Inputs from './Inputs'\nimport Outputs from './Outputs'\n\nconst Calculator = () => {\n  const [inputs, setInputs] = useState([]);\n  const [outputs, setOutputs] = useState([]);\n  const [workbook, setWorkbook] = useState(null);\n  const { register, handleSubmit, formState: { errors } } = useForm();\n  const onSubmit = data => setInputsToExcel(data);\n\n  const setInputsToExcel = (data) => {\n    if (workbook) {\n      const worksheet = workbook.Sheets[\"Lähtötiedot\"];\n      for (let key of Object.keys(data)) {\n        worksheet[key].v = parseFloat(data[key]);\n        worksheet[key].w = data[key]\n      }\n      getOutputsFromExcel();\n    } else {\n\n      alert('Lisääpä exceli ni lähtee toimimaan')\n    }\n  }\n\n  // https://github.com/fabiooshiro/xlsx-calc\n  const getOutputsFromExcel = () => {\n    // Tää ajaa kaikki funktiot\n    XLSX_CALC(workbook);\n\n    // Kopataan kaikki kilpailijat\n    // Otsikko rivillä 33\n    const companies = {\n      vip: {label: 'F', values: 'G', data: {}},\n      thermo: {label: 'I', values: 'J', data: {}},\n      rauheat: {label: 'L', values: 'M', data: {}},\n      calpex: {label: 'O', values: 'P', data: {}},\n      terrendis: {label: 'R', values: 'S', data: {}},\n      microflex: {label: 'U', values: 'V', data: {}},\n      meltex: {label: 'X', values: 'Y', data: {}} \n    }\n\n    const outputData = {\n      'Lämpöhäviöt': {labels: [], companies: []},\n      'Lämpöhäviökustannukset': {labels: [], companies: []},\n      'Kumulatiivinen Lämpöhäviökustannus': {labels: [], companies: []},\n      'Ero Ecoflex Vip Tuotteisiin': {labels: [], companies: []},\n    }\n\n    if (workbook) {\n      const outputSheet = workbook.SheetNames[2];\n      const worksheet = workbook.Sheets[outputSheet];\n      \n      // ==== Lämpöhäviöt ===== 34-36\n      const lampohavioArray = _.range(34, 37);\n      let lampohavioLabels = [];      \n      lampohavioLabels.push(\"Merkki:\")  \n      for (let value of lampohavioArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        lampohavioLabels.push(label);\n      }\n      outputData['Lämpöhäviöt'].labels = lampohavioLabels;\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of lampohavioArray) {\n          const values = worksheet[`${companies[company].values}${value}`].v;\n          \n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Lämpöhäviöt'].companies.push(yritys);\n        \n      }\n\n      // ==== Lämpöhäviökustannukset ==== 38-40 \n      const kustannuksetArray = _.range(38, 41);\n      let kustannuksetLabels = [];   \n      kustannuksetLabels.push(\"Merkki:\")     \n      for (let value of kustannuksetArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        kustannuksetLabels.push(label);\n      }\n      outputData['Lämpöhäviökustannukset'].labels = kustannuksetLabels;\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of kustannuksetArray) {\n          const values = worksheet[`${companies[company].values}${value}`].v;\n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Lämpöhäviökustannukset'].companies.push(yritys);\n      }\n\n      //  ===== Kumulatiiviset kustannukset =======\n      const kumulatiivisetArray = _.range(43, 47);\n      let kumulatiivisetLabels = [];\n      kumulatiivisetLabels.push('Merkki:')        \n      for (let value of kumulatiivisetArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        kumulatiivisetLabels.push(label);\n      }\n      outputData['Kumulatiivinen Lämpöhäviökustannus'].labels = kumulatiivisetLabels;\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of kumulatiivisetArray) {\n          const values = worksheet[`${companies[company].values}${value}`].v;\n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Kumulatiivinen Lämpöhäviökustannus'].companies.push(yritys);\n      }\n\n      //  ===== Ero ecoflex tuotteisiin =======\n      const eroArray = _.range(49, 52);\n      let eroLabels = []; \n      eroLabels.push(\"Merkki:\")       \n      for (let value of eroArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        eroLabels.push(label);\n      }\n      outputData['Ero Ecoflex Vip Tuotteisiin'].labels = eroLabels;\n\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of eroArray) {\n          let values = 0;\n          \n          if (worksheet[`${companies[company].values}${value}`] === undefined) {\n            values = 0;   \n          }\n          else {\n            values = worksheet[`${companies[company].values}${value}`].v;\n          }\n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Ero Ecoflex Vip Tuotteisiin'].companies.push(yritys);\n      }\n      setOutputs(outputData);\n    }\n  }\n\n  const createLocationString = (letter, number) => letter + number.toString();\n\n  useEffect(() => {\n    const readExcel = () => {\n      const input = document.getElementById('input');\n      input && input.addEventListener('change', handleExcelUpload, false);\n    }\n    const handleExcelUpload = (e) => {\n      e.preventDefault();\n  \n      const files = e.target.files;\n      const f = files[0];\n      \n      const reader = new FileReader();\n      // Tällä avataan workbook\n      reader.onload = function (e) {\n          var data = e.target.result;\n          let workbook = XLSX.read(data, {type: 'binary'});\n          \n          workbook && createInputs(workbook);\n          setWorkbook(workbook);\n      };\n      reader.readAsBinaryString(f)\n    }\n\n    const createInputs = (workbook) => {\n      var worksheet = workbook.Sheets[\"Lähtötiedot\"];\n      \n      // ====== PUTKET ======\n      // THERMO C/D 5-17\n      const thermoArray = _.range(5, 18);\n      const inputsArray = [];\n      const putket = [];\n  \n      putket.push(<div className=\"otsikko\">THERMO</div>);\n      for (let value of thermoArray) { \n        putket.push(createInput(worksheet[createLocationString('C', value)], worksheet[createLocationString('D', value)], createLocationString('D', value)));    \n      }\n  \n      // AQUA C/D 20-29\n      const aquaArray = _.range(20, 30);\n      putket.push(<div className=\"otsikko\">AQUA</div>);\n      for (let value of aquaArray) { \n        putket.push(createInput(worksheet[createLocationString('C', value)], worksheet[createLocationString('D', value)], createLocationString('D', value)));    \n      }\n      // Tehdään blocki\n      const putketBlock = <div key=\"putketBlock\" className=\"inputBlock\">{putket}</div>;\n      inputsArray.push(putketBlock);\n\n      // ====== Lämpötilat ========\n      // F/G 5-9\n      const lampotilaArray = _.range(5,10);\n      const lampotilat = [];\n      lampotilat.push(<div className=\"otsikko\">LÄMPÖTILAT</div>);\n      for (let value of lampotilaArray) {\n        lampotilat.push(createInput(worksheet[createLocationString('F', value)], worksheet[createLocationString('G', value)], createLocationString('G', value)));\n      }\n      const lampotilatBlock = <div key=\"lampotilatBlock\" className=\"inputBlock\">{lampotilat}</div>;\n      inputsArray.push(lampotilatBlock);\n\n      // ======= Käyttöajat =======\n      // F/G 11-12\n      const kayttoajatArray = _.range(11,13);\n      const kayttoajat = [];\n      kayttoajat.push(<div className=\"otsikko\">KÄYTTÖAIKA (Tuntia Vuodessa)</div>);\n      for (let value of kayttoajatArray) {\n        kayttoajat.push(createInput(worksheet[createLocationString('F', value)], worksheet[createLocationString('G', value)], createLocationString('G', value)));\n      }\n      const kayttoajatBlock = <div key=\"kayttoajatBlock\" className=\"inputBlock\">{kayttoajat}</div>;\n      inputsArray.push(kayttoajatBlock);\n\n      // ====== Energian hinta =======\n      const energianHintaArray = _.range(14,15);\n      const energianHinta = [];\n      energianHinta.push(<div className=\"otsikko\">ENERGIAN HINTA (€/kWh)</div>);\n      for (let value of energianHintaArray) {\n        energianHinta.push(createInput(worksheet[createLocationString('F', value)], worksheet[createLocationString('G', value)], createLocationString('G', value)));\n      }\n      const energianHintaBlock = <div key=\"energianhintaBlock\" className=\"inputBlock\">{energianHinta}</div>;\n      inputsArray.push(energianHintaBlock);\n      setInputs(inputsArray);\n    }\n\n    const createInput = (label, value, location) => {\n      const labelValue = label.v ? label.v : \"undefined\";\n      const valueValue = value.v ? value.v : 0;\n  \n      return <div className=\"row\" key={`${label}-${location}`}><label>{labelValue}</label><input defaultValue={valueValue} {...register(location, {min: 0, max: 99999})}  /></div> \n    }\n\n    readExcel(); \n  }, [register]);\n\n  return (\n    <div className=\"container\">\n      <div className=\"input\">\n        <h1>Tiputa tähän excel</h1>\n        <input id=\"input\" type=\"file\"></input>\n      </div>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <Inputs inputs={inputs} />\n        <input className=\"submit\" type=\"submit\" value=\"Laske\"></input>\n        {Object.keys(errors).length > 0 && <p className=\"red\">Syöttövirhe</p>}\n      </form>\n      <Outputs outputs={outputs} />\n    </div>\n  );\n};\n\nexport default Calculator;\n","import Calculator from './components/Calculator';\n\nfunction App() {\n  return (\n    <div className=\"container\">\n      <img alt=\"logo\" src=\"https://www.uponor.fi/-/media/uponor-internet/logos/uponor-logo.svg?la=fi-FI&hash=AACF752265B07BFE259A4FAD36EA34174B922D21\"></img>\n      <h1>Lämpöhävikkilaskuri</h1>\n      <p>Excel-taulukko täytyy tässä versiossa vielä lisätä käsin, tulevaisuudessa voidaan ladata palvelimelta.</p>\n      <Calculator />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}