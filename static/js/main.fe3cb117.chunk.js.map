{"version":3,"sources":["components/Inputs.js","components/Companies.js","components/Outputs.js","components/Calculator.js","laskuri.xlsx","App.js","index.js"],"names":["Inputs","inputs","className","Companies","data","Object","keys","map","key","i","nimi","value","position","length","toFixed","Outputs","outputs","console","log","labels","label","companies","Calculator","useState","setInputs","setOutputs","workbook","setWorkbook","useForm","register","handleSubmit","errors","watch","formState","setInputsToExcel","worksheet","Sheets","v","parseFloat","w","getOutputsFromExcel","alert","XLSX_CALC","vip","values","thermo","rauheat","calpex","terrendis","microflex","meltex","outputData","outputSheet","SheetNames","lampohavioArray","_","range","lampohavioLabels","push","company","yritys","parseInt","kustannuksetArray","kustannuksetLabels","kumulatiivisetArray","kumulatiivisetLabels","eroArray","eroLabels","undefined","createLocationString","letter","number","toString","useEffect","handleExcelUpload","e","preventDefault","f","target","files","reader","FileReader","onload","result","XLSX","read","type","createInputs","readAsBinaryString","thermoArray","inputsArray","putket","createInput","aquaArray","putketBlock","lampotilaArray","lampotilat","lampotilatBlock","kayttoajatArray","kayttoajat","kayttoajatBlock","energianHintaArray","energianHinta","energianHintaBlock","location","labelValue","valueValue","defaultValue","min","max","input","document","getElementById","addEventListener","readExcel","id","onSubmit","App","alt","src","ReactDOM","render"],"mappings":"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","file":"static/js/main.fe3cb117.chunk.js","sourcesContent":["const Inputs = ({inputs}) => {\n  return (\n    <div className=\"form\">\n      {inputs}\n    </div>\n  )\n};\n\nexport default Inputs;\n","const Companies = ({data}) => {\n  const calculateClassName = (position, length) => {\n    return position === length - 1 ? 'bold' : '';\n  }\n  return (\n    Object.keys(data).map((key,i) => (\n      <div className=\"company\" key={`company-${i}`}>\n        <div className=\"bold\">{data[key].nimi}</div>\n      <div className=\"column\">\n        {data[key].data.map((value,i) => <div className={calculateClassName(i, data[key].data.length)} key={`${value}-${i}`}>{value.toFixed(0)}</div>)}     \n      </div>\n      </div>\n\n    ))\n  );\n};\n\nexport default Companies;\n","import Companies from \"./Companies\";\n\nconst Outputs = ({outputs}) => {\n  console.log(outputs);\n  const keys = Object.keys(outputs);\n\n  const calculateClassName = (position, length) => {\n    return position === length - 1 ? 'bold' : '';\n  }\n\n  return (\n    <div>\n      {keys.map(key => (\n        <div>\n        <div className=\"otsikko\">{key}</div>\n        <div className=\"row\">\n          <div className=\"column\">\n            {outputs[key].labels.map((label,i) => <div className={calculateClassName(i, outputs[key].labels.length)} key={label}>{label}</div>)}     \n          </div>\n            <Companies data={outputs[key].companies} />\n        </div>    \n        </div>  \n      ))}\n    </div>\n  )\n  \n};\n\nexport default Outputs;\n","import React, { useEffect, useState } from 'react';\nimport XLSX from 'xlsx';\nimport XLSX_CALC from 'xlsx-calc';\nimport _ from 'lodash';\nimport { useForm } from \"react-hook-form\";\nimport Inputs from './Inputs'\nimport Outputs from './Outputs'\n\nconst Calculator = () => {\n  const [inputs, setInputs] = useState([]);\n  const [outputs, setOutputs] = useState([]);\n  const [workbook, setWorkbook] = useState(null);\n  const { register, handleSubmit, watch, formState: { errors } } = useForm();\n  const onSubmit = data => setInputsToExcel(data);\n\n  const setInputsToExcel = (data) => {\n    if (workbook) {\n      const worksheet = workbook.Sheets[\"Lähtötiedot\"];\n      console.log(data);\n      for (let key of Object.keys(data)) {\n        worksheet[key].v = parseFloat(data[key]);\n        worksheet[key].w = data[key]\n      }\n      getOutputsFromExcel();\n    } else {\n\n      alert('Lisääpä exceli ni lähtee toimimaan')\n    }\n  }\n\n  // https://github.com/fabiooshiro/xlsx-calc\n  const getOutputsFromExcel = () => {\n    XLSX_CALC(workbook);\n    console.log(workbook);\n\n    // Kopataan kaikki kilpailijat\n    // Otsikko rivillä 33\n    const companies = {\n      vip: {label: 'F', values: 'G', data: {}},\n      thermo: {label: 'I', values: 'J', data: {}},\n      rauheat: {label: 'L', values: 'M', data: {}},\n      calpex: {label: 'O', values: 'P', data: {}},\n      terrendis: {label: 'R', values: 'S', data: {}},\n      microflex: {label: 'U', values: 'V', data: {}},\n      meltex: {label: 'X', values: 'Y', data: {}} \n    }\n\n    const outputData = {\n      'Lämpöhäviöt': {labels: [], companies: []},\n      'Lämpöhäviökustannukset': {labels: [], companies: []},\n      'Kumulatiivinen Lämpöhäviökustannus': {labels: [], companies: []},\n      'Ero Ecoflex Vip Tuotteisiin': {labels: [], companies: []},\n    }\n\n    if (workbook) {\n      const outputSheet = workbook.SheetNames[2];\n      const worksheet = workbook.Sheets[outputSheet];\n      \n      // ==== Lämpöhäviöt ===== 34-36\n      const lampohavioArray = _.range(34, 37);\n      let lampohavioLabels = [];      \n      lampohavioLabels.push(\"Merkki:\")  \n      for (let value of lampohavioArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        lampohavioLabels.push(label);\n      }\n      outputData['Lämpöhäviöt'].labels = lampohavioLabels;\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of lampohavioArray) {\n          const values = worksheet[`${companies[company].values}${value}`].v;\n          \n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Lämpöhäviöt'].companies.push(yritys);\n        \n      }\n\n      // ==== Lämpöhäviökustannukset ==== 38-40 \n      const kustannuksetArray = _.range(38, 41);\n      let kustannuksetLabels = [];   \n      kustannuksetLabels.push(\"Merkki:\")     \n      for (let value of kustannuksetArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        kustannuksetLabels.push(label);\n      }\n      outputData['Lämpöhäviökustannukset'].labels = kustannuksetLabels;\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of kustannuksetArray) {\n          const values = worksheet[`${companies[company].values}${value}`].v;\n          console.log(worksheet[`${companies[company].values}${value}`])\n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Lämpöhäviökustannukset'].companies.push(yritys);\n      }\n\n      //  ===== Kumulatiiviset kustannukset =======\n      const kumulatiivisetArray = _.range(43, 47);\n      let kumulatiivisetLabels = [];\n      kumulatiivisetLabels.push('Merkki:')        \n      for (let value of kumulatiivisetArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        kumulatiivisetLabels.push(label);\n      }\n      outputData['Kumulatiivinen Lämpöhäviökustannus'].labels = kumulatiivisetLabels;\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of kumulatiivisetArray) {\n          const values = worksheet[`${companies[company].values}${value}`].v;\n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Kumulatiivinen Lämpöhäviökustannus'].companies.push(yritys);\n      }\n\n      //  ===== Ero ecoflex tuotteisiin =======\n      const eroArray = _.range(49, 52);\n      let eroLabels = []; \n      eroLabels.push(\"Merkki:\")       \n      for (let value of eroArray) {\n        const label = worksheet[`C${value}`].v + \" \" + worksheet[`D${value}`].v + \":\";\n        eroLabels.push(label);\n      }\n      outputData['Ero Ecoflex Vip Tuotteisiin'].labels = eroLabels;\n\n\n      for (let company of Object.keys(companies)) {\n        let yritys = {};\n        const locationString = companies[company].label + '33';\n        const nimi = worksheet[locationString].v;\n        const data = [];\n        for (let value of eroArray) {\n          let values = 0;\n          console.log('eroarray', worksheet[`${companies[company].values}${value}`]);\n          console.log(`${companies[company].values}${value}`);\n\n          \n          if (worksheet[`${companies[company].values}${value}`] === undefined) {\n            values = 0;   \n          }\n          else {\n            values = worksheet[`${companies[company].values}${value}`].v;\n          }\n          data.push(parseInt(values));\n        }\n        yritys['nimi'] = nimi;\n        yritys['data'] = data;\n        outputData['Ero Ecoflex Vip Tuotteisiin'].companies.push(yritys);\n      }\n      setOutputs(outputData);\n    }\n  }\n\n  const createLocationString = (letter, number) => letter + number.toString();\n\n  useEffect(() => {\n    const readExcel = () => {\n      const input = document.getElementById('input');\n      input && input.addEventListener('change', handleExcelUpload, false);\n    }\n    const handleExcelUpload = (e) => {\n      e.preventDefault();\n  \n      const files = e.target.files;\n      const f = files[0];\n      \n      const reader = new FileReader();\n      // Tällä avataan workbook\n      reader.onload = function (e) {\n          var data = e.target.result;\n          let workbook = XLSX.read(data, {type: 'binary'});\n          \n          workbook && createInputs(workbook);\n          setWorkbook(workbook);\n      };\n      reader.readAsBinaryString(f)\n    }\n\n    const createInputs = (workbook) => {\n      var worksheet = workbook.Sheets[\"Lähtötiedot\"];\n      \n      // ====== PUTKET ======\n      // THERMO C/D 5-17\n      const thermoArray = _.range(5, 18);\n      const inputsArray = [];\n      const putket = [];\n  \n      putket.push(<div className=\"otsikko\">THERMO</div>);\n      for (let value of thermoArray) { \n        putket.push(createInput(worksheet[createLocationString('C', value)], worksheet[createLocationString('D', value)], createLocationString('D', value)));    \n      }\n  \n      // AQUA C/D 20-29\n      const aquaArray = _.range(20, 30);\n      putket.push(<div className=\"otsikko\">AQUA</div>);\n      for (let value of aquaArray) { \n        putket.push(createInput(worksheet[createLocationString('C', value)], worksheet[createLocationString('D', value)], createLocationString('D', value)));    \n      }\n      // Tehdään blocki\n      const putketBlock = <div className=\"inputBlock\">{putket}</div>;\n      inputsArray.push(putketBlock);\n\n      // ====== Lämpötilat ========\n      // F/G 5-9\n      const lampotilaArray = _.range(5,10);\n      const lampotilat = [];\n      lampotilat.push(<div className=\"otsikko\">LÄMPÖTILAT</div>);\n      for (let value of lampotilaArray) {\n        lampotilat.push(createInput(worksheet[createLocationString('F', value)], worksheet[createLocationString('G', value)], createLocationString('G', value)));\n      }\n      const lampotilatBlock = <div className=\"inputBlock\">{lampotilat}</div>;\n      inputsArray.push(lampotilatBlock);\n\n      // ======= Käyttöajat =======\n      // F/G 11-12\n      const kayttoajatArray = _.range(11,13);\n      const kayttoajat = [];\n      kayttoajat.push(<div className=\"otsikko\">KÄYTTÖAIKA (Tuntia Vuodessa)</div>);\n      for (let value of kayttoajatArray) {\n        kayttoajat.push(createInput(worksheet[createLocationString('F', value)], worksheet[createLocationString('G', value)], createLocationString('G', value)));\n      }\n      const kayttoajatBlock = <div className=\"inputBlock\">{kayttoajat}</div>;\n      inputsArray.push(kayttoajatBlock);\n\n      // ====== Energian hinta =======\n      const energianHintaArray = _.range(14,15);\n      const energianHinta = [];\n      energianHinta.push(<div className=\"otsikko\">ENERGIAN HINTA (€/kWh)</div>);\n      for (let value of energianHintaArray) {\n        energianHinta.push(createInput(worksheet[createLocationString('F', value)], worksheet[createLocationString('G', value)], createLocationString('G', value)));\n      }\n      const energianHintaBlock = <div className=\"inputBlock\">{energianHinta}</div>;\n      inputsArray.push(energianHintaBlock);\n      setInputs(inputsArray);\n    }\n\n    const createInput = (label, value, location) => {\n      const labelValue = label.v ? label.v : \"undefined\";\n      const valueValue = value.v ? value.v : 0;\n  \n      return <div className=\"row\"><label>{labelValue}</label><input defaultValue={valueValue} {...register(location, {min: 0, max: 99999})}  /></div> \n    }\n\n    readExcel(); \n  }, [register]);\n\n  return (\n    <div className=\"container\">\n      <div className=\"input\">\n        <h1>Tiputa tähän excel</h1>\n        <input id=\"input\" type=\"file\"></input>\n      </div>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <Inputs inputs={inputs} />\n        <input className=\"submit\" type=\"submit\" value=\"Laske\"></input>\n        {errors && <p className=\"red\">Syöttövirhe</p>}\n      </form>\n      <Outputs outputs={outputs} />\n    </div>\n  );\n};\n\nexport default Calculator;\n","export default __webpack_public_path__ + \"static/media/laskuri.694ed339.xlsx\";","import Calculator from './components/Calculator';\nimport Calculator2 from './components/Calculator2';\n\nfunction App() {\n  return (\n    <div className=\"container\">\n      <img alt=\"logo\" src=\"https://www.uponor.fi/-/media/uponor-internet/logos/uponor-logo.svg?la=fi-FI&hash=AACF752265B07BFE259A4FAD36EA34174B922D21\"></img>\n      <h1>Lämpöhävikkilaskuri</h1>\n      <p>Excel-taulukko täytyy tässä versiossa vielä lisätä käsin, tulevaisuudessa voidaan ladata palvelimelta.</p>\n      <Calculator />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n    <App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}